<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Sarang Shah" name="author"/><link href="https://sshah1502.github.io/irgsc/userguide/" rel="canonical"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<title>UserGuide - irgsctool</title>
<link href="../css/theme.css" rel="stylesheet"/>
<link href="../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" rel="stylesheet"/>
<link href="../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "UserGuide";
        var mkdocs_page_input_path = "userguide.md";
        var mkdocs_page_url = "/irgsc/userguide/";
      </script>
<script defer="" src="../js/jquery-3.6.0.min.js"></script>
<!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            </style><script src="../assets/javascripts/glightbox.min.js"></script></head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a href="..">
<img alt="Logo" class="logo" src="../img/TMTLOGO.PNG"/>
</a><div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="..">Home</a>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../apireference/">API</a>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal current" href="./">UserGuide</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._validate">irgsctool._validate</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#irgsctool._validate.ValidateIRGSC">ValidateIRGSC</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._validate.ValidateIRGSC.read_irgsc">read_irgsc()</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#irgsctool._validate.ValidateIRGSC.validate">validate()</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/">Tutorials</a>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements/">Acknowledgements</a>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license/">License</a>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="..">irgsctool</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a alt="Docs" class="icon icon-home" href=".."></a> Â»</li>
<li>UserGuide</li>
<li class="wy-breadcrumbs-aside">
<a class="icon icon-github" href="https://github.com/sshah1502/irgsc/tree/main/documentation/docs/userguide.md"> Edit on GitHub</a>
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="user-guide">User Guide</h1>
<hr/>
<div class="doc doc-object doc-module">
<a id="irgsctool._validate"></a>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="irgsctool._validate.ValidateIRGSC">
<code>ValidateIRGSC</code>
</h2>
<div class="doc doc-contents">
<hr/>
<p>The <strong><em>Validate</em></strong> class includes functions to validate the generated irgsc,
generate a validated catalog and plot the comparison of the
observed and computed NIR magnitudes.</p>
<details class="quote">
<summary>Source code in <code>irgsctool/_validate.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ValidateIRGSC</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    ------------------------------------------</span>
<span class="sd">    The ***Validate*** class includes functions to validate the generated irgsc,</span>
<span class="sd">    generate a validated catalog and plot the comparison of the</span>
<span class="sd">    observed and computed NIR magnitudes.</span>

<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dec</span> <span class="o">=</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rd</span> <span class="o">=</span> <span class="n">ReadData</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span><span class="n">dec</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_irgsc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        ***irgsctool.validate.read_irgsc()*** reads the generated IRGSC for a given set of coordinates.</span>
<span class="sd">        Raises:</span>
<span class="sd">                FileNotFoundError: if there is no generated IRGSC available and then generates it.</span>

<span class="sd">        """</span>
        <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
        <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">'IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span>\
                      <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ps1_objid</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">];</span> <span class="n">err_ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">];</span> <span class="n">ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">];</span> \
            <span class="n">err_ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">];</span> <span class="n">ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">];</span> <span class="n">e_ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">];</span> <span class="n">ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">];</span> \
            <span class="n">e_ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">8</span><span class="p">];</span> <span class="n">ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">9</span><span class="p">];</span> <span class="n">e_ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">];</span> <span class="n">ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">11</span><span class="p">];</span> \
            <span class="n">e_ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">12</span><span class="p">];</span> <span class="n">ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">13</span><span class="p">];</span> <span class="n">e_ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">14</span><span class="p">];</span> <span class="n">teff</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">15</span><span class="p">];</span> \
                <span class="n">logg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">16</span><span class="p">];</span> <span class="n">feh</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">17</span><span class="p">];</span> <span class="n">sam_g</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">18</span><span class="p">];</span> <span class="n">sam_r</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">19</span><span class="p">];</span> <span class="n">sam_i</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">20</span><span class="p">];</span> <span class="n">sam_z</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">21</span><span class="p">];</span>\
                <span class="n">sam_y</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">22</span><span class="p">];</span> <span class="n">sam_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">23</span><span class="p">];</span> <span class="n">sam_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">24</span><span class="p">];</span> <span class="n">sam_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">25</span><span class="p">];</span> <span class="n">sf_avg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">26</span><span class="p">];</span> <span class="n">sigma_sf</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">27</span><span class="p">];</span>\
                    <span class="n">min_dquad_element</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">28</span><span class="p">];</span> <span class="n">computed_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">29</span><span class="p">];</span> <span class="n">computed_j_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">30</span><span class="p">];</span> <span class="n">computed_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">31</span><span class="p">];</span>\
                    <span class="n">computed_h_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">32</span><span class="p">];</span> <span class="n">computed_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">33</span><span class="p">];</span> <span class="n">computed_k_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">34</span><span class="p">];</span>\
                        <span class="n">gaia_source_id</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">35</span><span class="p">];</span> <span class="n">gaia_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">36</span><span class="p">];</span> <span class="n">gaia_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">37</span><span class="p">];</span>\
                        <span class="n">gaia_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">38</span><span class="p">];</span> <span class="n">gaia_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">39</span><span class="p">];</span> <span class="n">gaia_parallax</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">40</span><span class="p">];</span>\
                            <span class="n">gaia_parallax_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">41</span><span class="p">];</span> <span class="n">gaia_pm</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">42</span><span class="p">];</span> <span class="n">gaia_pm_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">43</span><span class="p">];</span> <span class="n">gaia_pm_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">44</span><span class="p">];</span>\
                            <span class="n">gaia_pm_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">45</span><span class="p">];</span> <span class="n">gaia_pm_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">46</span><span class="p">];</span> <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">47</span><span class="p">];</span>\
                                <span class="n">objinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">48</span><span class="p">];</span> <span class="n">qualityflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">49</span><span class="p">];</span> <span class="n">ndetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">50</span><span class="p">];</span>\
                                    <span class="n">nstackdetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">51</span><span class="p">];</span> <span class="n">ginfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">52</span><span class="p">];</span> <span class="n">ginfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">53</span><span class="p">];</span>\
                                        <span class="n">ginfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">54</span><span class="p">];</span> <span class="n">rinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">55</span><span class="p">];</span> <span class="n">rinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">56</span><span class="p">];</span>\
                                        <span class="n">rinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">57</span><span class="p">];</span> <span class="n">iinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">58</span><span class="p">];</span> <span class="n">iinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">59</span><span class="p">];</span>\
                                            <span class="n">iinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">60</span><span class="p">];</span> <span class="n">zinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">61</span><span class="p">];</span> <span class="n">zinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">62</span><span class="p">];</span>\
                                            <span class="n">zinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">63</span><span class="p">];</span> <span class="n">yinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">64</span><span class="p">];</span> <span class="n">yinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">65</span><span class="p">];</span>\
                                            <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">66</span><span class="p">]</span>
            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span>\
            <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">teff</span><span class="p">,</span> <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span>\
                <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span><span class="p">,</span> <span class="n">sf_avg</span><span class="p">,</span> <span class="n">sigma_sf</span><span class="p">,</span> <span class="n">min_dquad_element</span><span class="p">,</span>\
                <span class="n">computed_j</span><span class="p">,</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">,</span> <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="p">,</span>\
                    <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span> <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span>\
                    <span class="n">gaia_parallax_error</span><span class="p">,</span> <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
                        <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span>\
                        <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span>\
                            <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                            <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">gc</span> <span class="o">=</span> <span class="n">GenerateIRGSC</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">generate_irgsc</span><span class="p">()</span>
            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">'IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span>\
                      <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ps1_objid</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">];</span> <span class="n">err_ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">];</span> <span class="n">ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">];</span> \
            <span class="n">err_ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">];</span> <span class="n">ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">];</span> <span class="n">e_ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">];</span> <span class="n">ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">];</span> \
            <span class="n">e_ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">8</span><span class="p">];</span> <span class="n">ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">9</span><span class="p">];</span> <span class="n">e_ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">];</span> <span class="n">ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">11</span><span class="p">];</span> \
            <span class="n">e_ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">12</span><span class="p">];</span> <span class="n">ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">13</span><span class="p">];</span> <span class="n">e_ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">14</span><span class="p">];</span> <span class="n">teff</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">15</span><span class="p">];</span> \
                <span class="n">logg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">16</span><span class="p">];</span> <span class="n">feh</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">17</span><span class="p">];</span> <span class="n">sam_g</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">18</span><span class="p">];</span> <span class="n">sam_r</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">19</span><span class="p">];</span> <span class="n">sam_i</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">20</span><span class="p">];</span> <span class="n">sam_z</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">21</span><span class="p">];</span>\
                <span class="n">sam_y</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">22</span><span class="p">];</span> <span class="n">sam_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">23</span><span class="p">];</span> <span class="n">sam_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">24</span><span class="p">];</span> <span class="n">sam_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">25</span><span class="p">];</span> <span class="n">sf_avg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">26</span><span class="p">];</span> <span class="n">sigma_sf</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">27</span><span class="p">];</span>\
                    <span class="n">min_dquad_element</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">28</span><span class="p">];</span> <span class="n">computed_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">29</span><span class="p">];</span> <span class="n">computed_j_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">30</span><span class="p">];</span> <span class="n">computed_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">31</span><span class="p">];</span>\
                    <span class="n">computed_h_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">32</span><span class="p">];</span> <span class="n">computed_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">33</span><span class="p">];</span> <span class="n">computed_k_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">34</span><span class="p">];</span>\
                        <span class="n">gaia_source_id</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">35</span><span class="p">];</span> <span class="n">gaia_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">36</span><span class="p">];</span> <span class="n">gaia_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">37</span><span class="p">];</span>\
                        <span class="n">gaia_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">38</span><span class="p">];</span> <span class="n">gaia_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">39</span><span class="p">];</span> <span class="n">gaia_parallax</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">40</span><span class="p">];</span>\
                            <span class="n">gaia_parallax_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">41</span><span class="p">];</span> <span class="n">gaia_pm</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">42</span><span class="p">];</span> <span class="n">gaia_pm_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">43</span><span class="p">];</span> <span class="n">gaia_pm_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">44</span><span class="p">];</span>\
                            <span class="n">gaia_pm_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">45</span><span class="p">];</span> <span class="n">gaia_pm_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">46</span><span class="p">];</span> <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">47</span><span class="p">];</span>\
                                <span class="n">objinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">48</span><span class="p">];</span> <span class="n">qualityflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">49</span><span class="p">];</span> <span class="n">ndetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">50</span><span class="p">];</span>\
                                    <span class="n">nstackdetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">51</span><span class="p">];</span> <span class="n">ginfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">52</span><span class="p">];</span> <span class="n">ginfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">53</span><span class="p">];</span>\
                                        <span class="n">ginfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">54</span><span class="p">];</span> <span class="n">rinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">55</span><span class="p">];</span> <span class="n">rinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">56</span><span class="p">];</span>\
                                        <span class="n">rinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">57</span><span class="p">];</span> <span class="n">iinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">58</span><span class="p">];</span> <span class="n">iinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">59</span><span class="p">];</span>\
                                            <span class="n">iinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">60</span><span class="p">];</span> <span class="n">zinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">61</span><span class="p">];</span> <span class="n">zinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">62</span><span class="p">];</span>\
                                            <span class="n">zinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">63</span><span class="p">];</span> <span class="n">yinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">64</span><span class="p">];</span> <span class="n">yinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">65</span><span class="p">];</span>\
                                            <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">66</span><span class="p">]</span>
            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span>\
            <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">teff</span><span class="p">,</span> <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span>\
                <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span><span class="p">,</span> <span class="n">sf_avg</span><span class="p">,</span> <span class="n">sigma_sf</span><span class="p">,</span> <span class="n">min_dquad_element</span><span class="p">,</span>\
                <span class="n">computed_j</span><span class="p">,</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">,</span> <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="p">,</span>\
                    <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span> <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span>\
                    <span class="n">gaia_parallax_error</span><span class="p">,</span> <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
                        <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span>\
                        <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span>\
                            <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                            <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span>
        <span class="k">return</span> <span class="n">irgsc_data</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">            Function to compare the observed and computed NIR magnitudes for a given field.</span>
<span class="sd">            If this is set to True, the function first obtains the UKIDSS data for the given field.</span>
<span class="sd">            Raises an error if UKIDSS data is not available.</span>
<span class="sd">            Raises warning if J and H band data from UKIDSS is not available.</span>
<span class="sd">        """</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'###############################################################################'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Now validating the generated IRGSC using the UKIDSS data file if it is present.'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'###############################################################################'</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">validate</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">ukidss_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">read_nir_data</span><span class="p">()</span>
            <span class="n">irgsc_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_irgsc</span><span class="p">()</span>
            <span class="n">ukidss_j</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">,</span> <span class="n">ukidss_ra</span><span class="p">,</span> <span class="n">ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_data</span>
            <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span>\
                <span class="n">e_ec_rmag</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">teff</span><span class="p">,</span>\
                <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span><span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span><span class="p">,</span> <span class="n">sf_avg</span><span class="p">,</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                    <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">,</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">,</span> <span class="n">computed_h_error</span><span class="p">,</span>\
                        <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="p">,</span> <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span>\
                            <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span> <span class="n">gaia_parallax_error</span><span class="p">,</span>\
                            <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span> <span class="n">gaia_pm_dec_error</span><span class="p">,</span>\
                                <span class="n">gaia_ruwe</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span> <span class="n">nstackdetections</span><span class="p">,</span>\
                                <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span> <span class="n">rinfoflag3</span><span class="p">,</span>\
                                    <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                                    <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span>

        <span class="n">validate_params</span><span class="o">=</span><span class="p">[];</span> <span class="n">ob_j</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_j</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">ob_h</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_h</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">ob_k</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_k</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">diff_jf</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">diff_hf</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">diff_kf</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">);</span> <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'validated_IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">file2</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file2</span><span class="p">)</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ps_ra</span><span class="p">)):</span>
                <span class="c1">#positionally matching the sources in the UKIDSS within 1" to the PS1 sources in the catalogue</span>
                <span class="n">gamma_ukidss</span> <span class="o">=</span> <span class="mi">3600</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ukidss_ra</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">])))</span><span class="o">**</span><span class="mi">2</span>\
                                      <span class="o">+</span> <span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ukidss_dec</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">index_ukidss_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gamma_ukidss</span><span class="o">&lt;=</span><span class="mf">1.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_ukidss_position</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">matched_positions</span> <span class="o">=</span> <span class="n">gamma_ukidss</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span>
                    <span class="n">minimum_seperation</span> <span class="o">=</span> <span class="n">gamma_ukidss</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">matched_positions</span><span class="p">)</span> <span class="o">==</span> <span class="n">gamma_ukidss</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="n">index_minimum_seperation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">minimum_seperation</span> <span class="o">==</span> <span class="n">gamma_ukidss</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">diff_j</span> <span class="o">=</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">diff_h</span> <span class="o">=</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">diff_k</span> <span class="o">=</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">validate_params</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">sam_r</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">min_dquad_element</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">gaia_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">ginfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">zinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">diff_j</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">,</span>\
                    <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span>\
                    <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span>
                    <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">validate_params</span><span class="p">)</span>
                    <span class="n">ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">e_ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_j</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">e_ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_h</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">e_ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_k</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                    <span class="n">diff_jf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">diff_j</span><span class="p">)</span>
                    <span class="n">diff_hf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">)</span>
                    <span class="n">diff_kf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_ukidss_position</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">diff_j</span> <span class="o">=</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">diff_h</span> <span class="o">=</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">diff_k</span> <span class="o">=</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                    <span class="n">validate_params</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">sam_r</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">min_dquad_element</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">gaia_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">ginfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                    <span class="n">zinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">diff_j</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">,</span>\
                    <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span>\
                    <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span>
                    <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">validate_params</span><span class="p">)</span>
                    <span class="n">ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">e_ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_j</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">e_ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_h</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">e_ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_k</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                    <span class="n">diff_jf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">diff_j</span><span class="p">)</span>
                    <span class="n">diff_hf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">)</span>
                    <span class="n">diff_kf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">)</span>

        <span class="n">indjp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">indhp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">indkp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">e_ob_j</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $J_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$J_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obj_vs_err_obj.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">e_ob_h</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $H_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$H_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obh_vs_err_obh.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">e_ob_k</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $K_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$K_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obk_vs_err_obk.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>


        <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">diff_jf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span>\
                        <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
        <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>\
                                    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
        <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                    <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                    <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Difference'</span><span class="p">)</span>
        <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median at:</span><span class="si">%0.2f</span><span class="s1">'</span><span class="o">%</span><span class="p">(</span><span class="n">by</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ny</span><span class="o">==</span><span class="n">biny_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)))</span>\
                           <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">))))</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($J_</span><span class="si">{o}</span><span class="s1">$ - $J_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span> \
                            <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indjp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="c1"># Turn off tick labels on marginals</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Set labels on joint</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed J magnitude'</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$J_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $J_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="c1"># Set labels on marginals</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_j'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>\
                    <span class="o">+</span><span class="s1">'.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">diff_hf</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">diff_hf</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">diff_hf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span>\
                            <span class="n">label</span> <span class="o">=</span> <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
        <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
        <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                 <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Difference'</span><span class="p">)</span>
        <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median at:</span><span class="si">%0.2f</span><span class="s1">'</span><span class="o">%</span><span class="p">(</span><span class="n">by</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ny</span><span class="o">==</span><span class="n">biny_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">)))</span>\
                           <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">))))</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($H_</span><span class="si">{o}</span><span class="s1">$ - $H_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span> \
                            <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indhp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="c1"># Turn off tick labels on marginals</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Set labels on joint</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed H magnitude'</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$H_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $H_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="c1"># Set labels on marginals</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_h'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">+</span>\
                    <span class="s1">'.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

        <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
        <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">diff_kf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span>\
                             <span class="n">label</span> <span class="o">=</span> <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
        <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                        <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
        <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                    <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span>\
                                        <span class="s1">'Difference'</span><span class="p">)</span>
        <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median at:</span><span class="si">%0.2f</span><span class="s1">'</span><span class="o">%</span><span class="p">(</span><span class="n">by</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ny</span><span class="o">==</span><span class="n">biny_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">)))</span>\
                           <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">))))</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($K_</span><span class="si">{o}</span><span class="s1">$ - $K_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span>\
                            <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indkp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
        <span class="c1"># Turn off tick labels on marginals</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Set labels on joint</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed K magnitude'</span><span class="p">)</span>
        <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$K_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $K_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
        <span class="c1"># Set labels on marginals</span>
        <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_k'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">+</span>\
                    <span class="s1">'.png'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._validate.ValidateIRGSC.read_irgsc">
<code class="highlight language-python"><span class="n">read_irgsc</span><span class="p">()</span></code>
</h3>
<div class="doc doc-contents">
<p><strong><em>irgsctool.validate.read_irgsc()</em></strong> reads the generated IRGSC for a given set of coordinates.</p>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code>FileNotFoundError</code>
</td>
<td><p>if there is no generated IRGSC available and then generates it.</p></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>irgsctool/_validate.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_irgsc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    ***irgsctool.validate.read_irgsc()*** reads the generated IRGSC for a given set of coordinates.</span>
<span class="sd">    Raises:</span>
<span class="sd">            FileNotFoundError: if there is no generated IRGSC available and then generates it.</span>

<span class="sd">    """</span>
    <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">)</span>
    <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">'IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span>\
                  <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ps1_objid</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">];</span> <span class="n">err_ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">];</span> <span class="n">ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">];</span> \
        <span class="n">err_ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">];</span> <span class="n">ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">];</span> <span class="n">e_ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">];</span> <span class="n">ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">];</span> \
        <span class="n">e_ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">8</span><span class="p">];</span> <span class="n">ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">9</span><span class="p">];</span> <span class="n">e_ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">];</span> <span class="n">ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">11</span><span class="p">];</span> \
        <span class="n">e_ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">12</span><span class="p">];</span> <span class="n">ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">13</span><span class="p">];</span> <span class="n">e_ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">14</span><span class="p">];</span> <span class="n">teff</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">15</span><span class="p">];</span> \
            <span class="n">logg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">16</span><span class="p">];</span> <span class="n">feh</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">17</span><span class="p">];</span> <span class="n">sam_g</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">18</span><span class="p">];</span> <span class="n">sam_r</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">19</span><span class="p">];</span> <span class="n">sam_i</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">20</span><span class="p">];</span> <span class="n">sam_z</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">21</span><span class="p">];</span>\
            <span class="n">sam_y</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">22</span><span class="p">];</span> <span class="n">sam_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">23</span><span class="p">];</span> <span class="n">sam_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">24</span><span class="p">];</span> <span class="n">sam_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">25</span><span class="p">];</span> <span class="n">sf_avg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">26</span><span class="p">];</span> <span class="n">sigma_sf</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">27</span><span class="p">];</span>\
                <span class="n">min_dquad_element</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">28</span><span class="p">];</span> <span class="n">computed_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">29</span><span class="p">];</span> <span class="n">computed_j_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">30</span><span class="p">];</span> <span class="n">computed_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">31</span><span class="p">];</span>\
                <span class="n">computed_h_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">32</span><span class="p">];</span> <span class="n">computed_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">33</span><span class="p">];</span> <span class="n">computed_k_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">34</span><span class="p">];</span>\
                    <span class="n">gaia_source_id</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">35</span><span class="p">];</span> <span class="n">gaia_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">36</span><span class="p">];</span> <span class="n">gaia_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">37</span><span class="p">];</span>\
                    <span class="n">gaia_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">38</span><span class="p">];</span> <span class="n">gaia_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">39</span><span class="p">];</span> <span class="n">gaia_parallax</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">40</span><span class="p">];</span>\
                        <span class="n">gaia_parallax_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">41</span><span class="p">];</span> <span class="n">gaia_pm</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">42</span><span class="p">];</span> <span class="n">gaia_pm_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">43</span><span class="p">];</span> <span class="n">gaia_pm_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">44</span><span class="p">];</span>\
                        <span class="n">gaia_pm_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">45</span><span class="p">];</span> <span class="n">gaia_pm_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">46</span><span class="p">];</span> <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">47</span><span class="p">];</span>\
                            <span class="n">objinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">48</span><span class="p">];</span> <span class="n">qualityflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">49</span><span class="p">];</span> <span class="n">ndetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">50</span><span class="p">];</span>\
                                <span class="n">nstackdetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">51</span><span class="p">];</span> <span class="n">ginfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">52</span><span class="p">];</span> <span class="n">ginfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">53</span><span class="p">];</span>\
                                    <span class="n">ginfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">54</span><span class="p">];</span> <span class="n">rinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">55</span><span class="p">];</span> <span class="n">rinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">56</span><span class="p">];</span>\
                                    <span class="n">rinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">57</span><span class="p">];</span> <span class="n">iinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">58</span><span class="p">];</span> <span class="n">iinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">59</span><span class="p">];</span>\
                                        <span class="n">iinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">60</span><span class="p">];</span> <span class="n">zinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">61</span><span class="p">];</span> <span class="n">zinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">62</span><span class="p">];</span>\
                                        <span class="n">zinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">63</span><span class="p">];</span> <span class="n">yinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">64</span><span class="p">];</span> <span class="n">yinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">65</span><span class="p">];</span>\
                                        <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">66</span><span class="p">]</span>
        <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span>\
        <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">teff</span><span class="p">,</span> <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span>\
            <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span><span class="p">,</span> <span class="n">sf_avg</span><span class="p">,</span> <span class="n">sigma_sf</span><span class="p">,</span> <span class="n">min_dquad_element</span><span class="p">,</span>\
            <span class="n">computed_j</span><span class="p">,</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">,</span> <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="p">,</span>\
                <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span> <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span>\
                <span class="n">gaia_parallax_error</span><span class="p">,</span> <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
                    <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span>\
                    <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span>\
                        <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                        <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="n">gc</span> <span class="o">=</span> <span class="n">GenerateIRGSC</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">generate_irgsc</span><span class="p">()</span>
        <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">'IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span>\
                  <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">','</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ps1_objid</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">];</span> <span class="n">err_ps_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">];</span> <span class="n">ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">3</span><span class="p">];</span> \
        <span class="n">err_ps_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">4</span><span class="p">];</span> <span class="n">ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">5</span><span class="p">];</span> <span class="n">e_ec_gmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">];</span> <span class="n">ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">7</span><span class="p">];</span> \
        <span class="n">e_ec_rmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">8</span><span class="p">];</span> <span class="n">ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">9</span><span class="p">];</span> <span class="n">e_ec_imag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">];</span> <span class="n">ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">11</span><span class="p">];</span> \
        <span class="n">e_ec_zmag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">12</span><span class="p">];</span> <span class="n">ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">13</span><span class="p">];</span> <span class="n">e_ec_ymag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">14</span><span class="p">];</span> <span class="n">teff</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">15</span><span class="p">];</span> \
            <span class="n">logg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">16</span><span class="p">];</span> <span class="n">feh</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">17</span><span class="p">];</span> <span class="n">sam_g</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">18</span><span class="p">];</span> <span class="n">sam_r</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">19</span><span class="p">];</span> <span class="n">sam_i</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">20</span><span class="p">];</span> <span class="n">sam_z</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">21</span><span class="p">];</span>\
            <span class="n">sam_y</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">22</span><span class="p">];</span> <span class="n">sam_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">23</span><span class="p">];</span> <span class="n">sam_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">24</span><span class="p">];</span> <span class="n">sam_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">25</span><span class="p">];</span> <span class="n">sf_avg</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">26</span><span class="p">];</span> <span class="n">sigma_sf</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">27</span><span class="p">];</span>\
                <span class="n">min_dquad_element</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">28</span><span class="p">];</span> <span class="n">computed_j</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">29</span><span class="p">];</span> <span class="n">computed_j_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">30</span><span class="p">];</span> <span class="n">computed_h</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">31</span><span class="p">];</span>\
                <span class="n">computed_h_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">32</span><span class="p">];</span> <span class="n">computed_k</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">33</span><span class="p">];</span> <span class="n">computed_k_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">34</span><span class="p">];</span>\
                    <span class="n">gaia_source_id</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">35</span><span class="p">];</span> <span class="n">gaia_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">36</span><span class="p">];</span> <span class="n">gaia_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">37</span><span class="p">];</span>\
                    <span class="n">gaia_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">38</span><span class="p">];</span> <span class="n">gaia_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">39</span><span class="p">];</span> <span class="n">gaia_parallax</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">40</span><span class="p">];</span>\
                        <span class="n">gaia_parallax_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">41</span><span class="p">];</span> <span class="n">gaia_pm</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">42</span><span class="p">];</span> <span class="n">gaia_pm_ra</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">43</span><span class="p">];</span> <span class="n">gaia_pm_ra_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">44</span><span class="p">];</span>\
                        <span class="n">gaia_pm_dec</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">45</span><span class="p">];</span> <span class="n">gaia_pm_dec_error</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">46</span><span class="p">];</span> <span class="n">gaia_ruwe</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">47</span><span class="p">];</span>\
                            <span class="n">objinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">48</span><span class="p">];</span> <span class="n">qualityflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">49</span><span class="p">];</span> <span class="n">ndetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">50</span><span class="p">];</span>\
                                <span class="n">nstackdetections</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">51</span><span class="p">];</span> <span class="n">ginfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">52</span><span class="p">];</span> <span class="n">ginfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">53</span><span class="p">];</span>\
                                    <span class="n">ginfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">54</span><span class="p">];</span> <span class="n">rinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">55</span><span class="p">];</span> <span class="n">rinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">56</span><span class="p">];</span>\
                                    <span class="n">rinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">57</span><span class="p">];</span> <span class="n">iinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">58</span><span class="p">];</span> <span class="n">iinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">59</span><span class="p">];</span>\
                                        <span class="n">iinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">60</span><span class="p">];</span> <span class="n">zinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">61</span><span class="p">];</span> <span class="n">zinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">62</span><span class="p">];</span>\
                                        <span class="n">zinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">63</span><span class="p">];</span> <span class="n">yinfoflag</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">64</span><span class="p">];</span> <span class="n">yinfoflag2</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">65</span><span class="p">];</span>\
                                        <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span><span class="p">[:,</span><span class="mi">66</span><span class="p">]</span>
        <span class="n">irgsc_data</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span> <span class="n">e_ec_rmag</span><span class="p">,</span>\
        <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">teff</span><span class="p">,</span> <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span>\
            <span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span><span class="p">,</span> <span class="n">sf_avg</span><span class="p">,</span> <span class="n">sigma_sf</span><span class="p">,</span> <span class="n">min_dquad_element</span><span class="p">,</span>\
            <span class="n">computed_j</span><span class="p">,</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">,</span> <span class="n">computed_h_error</span><span class="p">,</span> <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="p">,</span>\
                <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span> <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span>\
                <span class="n">gaia_parallax_error</span><span class="p">,</span> <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span>\
                    <span class="n">gaia_pm_dec_error</span><span class="p">,</span> <span class="n">gaia_ruwe</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span>\
                    <span class="n">nstackdetections</span><span class="p">,</span> <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span>\
                        <span class="n">rinfoflag3</span><span class="p">,</span> <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                        <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span>
    <span class="k">return</span> <span class="n">irgsc_data</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="irgsctool._validate.ValidateIRGSC.validate">
<code class="highlight language-python"><span class="n">validate</span><span class="p">(</span><span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
</h3>
<div class="doc doc-contents">
<p>Function to compare the observed and computed NIR magnitudes for a given field.
If this is set to True, the function first obtains the UKIDSS data for the given field.
Raises an error if UKIDSS data is not available.
Raises warning if J and H band data from UKIDSS is not available.</p>
<details class="quote">
<summary>Source code in <code>irgsctool/_validate.py</code></summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">        Function to compare the observed and computed NIR magnitudes for a given field.</span>
<span class="sd">        If this is set to True, the function first obtains the UKIDSS data for the given field.</span>
<span class="sd">        Raises an error if UKIDSS data is not available.</span>
<span class="sd">        Raises warning if J and H band data from UKIDSS is not available.</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'###############################################################################'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Now validating the generated IRGSC using the UKIDSS data file if it is present.'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'###############################################################################'</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">validate</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">ukidss_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rd</span><span class="o">.</span><span class="n">read_nir_data</span><span class="p">()</span>
        <span class="n">irgsc_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_irgsc</span><span class="p">()</span>
        <span class="n">ukidss_j</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">,</span> <span class="n">ukidss_ra</span><span class="p">,</span> <span class="n">ukidss_dec</span> <span class="o">=</span> <span class="n">ukidss_data</span>
        <span class="n">ps1_objid</span><span class="p">,</span> <span class="n">ps_ra</span><span class="p">,</span> <span class="n">err_ps_ra</span><span class="p">,</span> <span class="n">ps_dec</span><span class="p">,</span> <span class="n">err_ps_dec</span><span class="p">,</span> <span class="n">ec_gmag</span><span class="p">,</span> <span class="n">e_ec_gmag</span><span class="p">,</span> <span class="n">ec_rmag</span><span class="p">,</span>\
            <span class="n">e_ec_rmag</span><span class="p">,</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">,</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">,</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">,</span> <span class="n">teff</span><span class="p">,</span>\
            <span class="n">logg</span><span class="p">,</span> <span class="n">feh</span><span class="p">,</span> <span class="n">sam_g</span><span class="p">,</span><span class="n">sam_r</span><span class="p">,</span> <span class="n">sam_i</span><span class="p">,</span> <span class="n">sam_z</span><span class="p">,</span> <span class="n">sam_y</span><span class="p">,</span> <span class="n">sam_j</span><span class="p">,</span> <span class="n">sam_h</span><span class="p">,</span> <span class="n">sam_k</span><span class="p">,</span> <span class="n">sf_avg</span><span class="p">,</span> <span class="n">sigma_sf</span><span class="p">,</span>\
                <span class="n">min_dquad_element</span><span class="p">,</span> <span class="n">computed_j</span><span class="p">,</span> <span class="n">computed_j_error</span><span class="p">,</span> <span class="n">computed_h</span><span class="p">,</span> <span class="n">computed_h_error</span><span class="p">,</span>\
                    <span class="n">computed_k</span><span class="p">,</span> <span class="n">computed_k_error</span><span class="p">,</span> <span class="n">gaia_source_id</span><span class="p">,</span> <span class="n">gaia_ra</span><span class="p">,</span> <span class="n">gaia_ra_error</span><span class="p">,</span>\
                        <span class="n">gaia_dec</span><span class="p">,</span> <span class="n">gaia_dec_error</span><span class="p">,</span> <span class="n">gaia_parallax</span><span class="p">,</span> <span class="n">gaia_parallax_error</span><span class="p">,</span>\
                        <span class="n">gaia_pm</span><span class="p">,</span> <span class="n">gaia_pm_ra</span><span class="p">,</span> <span class="n">gaia_pm_ra_error</span><span class="p">,</span> <span class="n">gaia_pm_dec</span><span class="p">,</span> <span class="n">gaia_pm_dec_error</span><span class="p">,</span>\
                            <span class="n">gaia_ruwe</span><span class="p">,</span> <span class="n">objinfoflag</span><span class="p">,</span> <span class="n">qualityflag</span><span class="p">,</span> <span class="n">ndetections</span><span class="p">,</span> <span class="n">nstackdetections</span><span class="p">,</span>\
                            <span class="n">ginfoflag</span><span class="p">,</span> <span class="n">ginfoflag2</span><span class="p">,</span> <span class="n">ginfoflag3</span><span class="p">,</span> <span class="n">rinfoflag</span><span class="p">,</span> <span class="n">rinfoflag2</span><span class="p">,</span> <span class="n">rinfoflag3</span><span class="p">,</span>\
                                <span class="n">iinfoflag</span><span class="p">,</span> <span class="n">iinfoflag2</span><span class="p">,</span> <span class="n">iinfoflag3</span><span class="p">,</span> <span class="n">zinfoflag</span><span class="p">,</span> <span class="n">zinfoflag2</span><span class="p">,</span>\
                                <span class="n">zinfoflag3</span><span class="p">,</span> <span class="n">yinfoflag</span><span class="p">,</span> <span class="n">yinfoflag2</span><span class="p">,</span> <span class="n">yinfoflag3</span> <span class="o">=</span> <span class="n">irgsc_data</span>

    <span class="n">validate_params</span><span class="o">=</span><span class="p">[];</span> <span class="n">ob_j</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_j</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">ob_h</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_h</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">ob_k</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">e_ob_k</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">diff_jf</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">diff_hf</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">diff_kf</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ra_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'_'</span><span class="p">);</span> <span class="n">dec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'validated_IRGSC'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">current_datetime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'.csv'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">file2</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file2</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ps_ra</span><span class="p">)):</span>
            <span class="c1">#positionally matching the sources in the UKIDSS within 1" to the PS1 sources in the catalogue</span>
            <span class="n">gamma_ukidss</span> <span class="o">=</span> <span class="mi">3600</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ukidss_ra</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">])))</span><span class="o">**</span><span class="mi">2</span>\
                                  <span class="o">+</span> <span class="p">(</span><span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ukidss_dec</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">index_ukidss_position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gamma_ukidss</span><span class="o">&lt;=</span><span class="mf">1.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_ukidss_position</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">matched_positions</span> <span class="o">=</span> <span class="n">gamma_ukidss</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span>
                <span class="n">minimum_seperation</span> <span class="o">=</span> <span class="n">gamma_ukidss</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">matched_positions</span><span class="p">)</span> <span class="o">==</span> <span class="n">gamma_ukidss</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">index_minimum_seperation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">minimum_seperation</span> <span class="o">==</span> <span class="n">gamma_ukidss</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">diff_j</span> <span class="o">=</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">diff_h</span> <span class="o">=</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">diff_k</span> <span class="o">=</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">validate_params</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">sam_r</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">min_dquad_element</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">gaia_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">ginfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">zinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">diff_j</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">,</span>\
                <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span>\
                <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">],</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">]</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">validate_params</span><span class="p">)</span>
                <span class="n">ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">e_ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_j</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">e_ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_h</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">e_ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_k</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_minimum_seperation</span><span class="p">])</span>
                <span class="n">diff_jf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">diff_j</span><span class="p">)</span>
                <span class="n">diff_hf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">)</span>
                <span class="n">diff_kf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_ukidss_position</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">diff_j</span> <span class="o">=</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">diff_h</span> <span class="o">=</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">diff_k</span> <span class="o">=</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span> <span class="o">-</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                <span class="n">validate_params</span> <span class="o">=</span> <span class="n">ps1_objid</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">err_ps_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">e_ec_gmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">e_ec_rmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_imag</span><span class="p">,</span> <span class="n">e_ec_imag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_zmag</span><span class="p">,</span> <span class="n">e_ec_zmag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ec_ymag</span><span class="p">,</span> <span class="n">e_ec_ymag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">teff</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">logg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">feh</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_g</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">sam_r</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_i</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_z</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_y</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sam_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sf_avg</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">sigma_sf</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">min_dquad_element</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">computed_j</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_j_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_h_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">computed_k_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_source_id</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">gaia_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_parallax_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_ra</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">gaia_pm_ra_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_pm_dec_error</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">gaia_ruwe</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">objinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">qualityflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ndetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">nstackdetections</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">ginfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">ginfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">rinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">iinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span>\
                <span class="n">zinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">zinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag2</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">yinfoflag3</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span> <span class="n">diff_j</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">,</span>\
                <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span>\
                <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">],</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">]</span>
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">validate_params</span><span class="p">)</span>
                <span class="n">ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">e_ob_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_j</span><span class="p">,</span> <span class="n">e_ukidss_j</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">e_ob_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_h</span><span class="p">,</span> <span class="n">e_ukidss_h</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">e_ob_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e_ob_k</span><span class="p">,</span> <span class="n">e_ukidss_k</span><span class="p">[</span><span class="n">index_ukidss_position</span><span class="p">])</span>
                <span class="n">diff_jf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">diff_j</span><span class="p">)</span>
                <span class="n">diff_hf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">diff_h</span><span class="p">)</span>
                <span class="n">diff_kf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">diff_k</span><span class="p">)</span>

    <span class="n">indjp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">indhp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">indkp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">e_ob_j</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $J_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$J_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obj_vs_err_obj.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">e_ob_h</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $H_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$H_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obh_vs_err_obh.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">e_ob_k</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error in $K_</span><span class="si">{UKIDSS}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$K_</span><span class="si">{UKIDSS}</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'obk_vs_err_obk.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>


    <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">diff_jf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span>\
                    <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
    <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_j</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>\
                                <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
    <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Difference'</span><span class="p">)</span>
    <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median at:</span><span class="si">%0.2f</span><span class="s1">'</span><span class="o">%</span><span class="p">(</span><span class="n">by</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ny</span><span class="o">==</span><span class="n">biny_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)))</span>\
                       <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">))))</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($J_</span><span class="si">{o}</span><span class="s1">$ - $J_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span> \
                        <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indjp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="c1"># Turn off tick labels on marginals</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Set labels on joint</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed J magnitude'</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$J_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $J_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="c1"># Set labels on marginals</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_j'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>\
                <span class="o">+</span><span class="s1">'.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">diff_hf</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">diff_hf</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">diff_hf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span>\
                        <span class="n">label</span> <span class="o">=</span> <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
    <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_h</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                            <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
    <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                             <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'Difference'</span><span class="p">)</span>
    <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median at:</span><span class="si">%0.2f</span><span class="s1">'</span><span class="o">%</span><span class="p">(</span><span class="n">by</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ny</span><span class="o">==</span><span class="n">biny_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">)))</span>\
                       <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">))))</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($H_</span><span class="si">{o}</span><span class="s1">$ - $H_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span> \
                        <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indhp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_hf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="c1"># Turn off tick labels on marginals</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Set labels on joint</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed H magnitude'</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$H_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $H_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="c1"># Set labels on marginals</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_h'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">+</span>\
                <span class="s1">'.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

    <span class="n">bins2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">diff_jf</span><span class="p">)</span><span class="o">+</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax_joint</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_x</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_marg_y</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">diff_kf</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span>\
                         <span class="n">label</span> <span class="o">=</span> <span class="s1">'No. of stars ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ob_j</span><span class="p">)))</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="s1">'best'</span><span class="p">)</span>
    <span class="n">nx</span><span class="p">,</span> <span class="n">bx</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ob_k</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">'m'</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>\
                                    <span class="n">label</span> <span class="o">=</span> <span class="s1">'Observed J'</span><span class="p">)</span>
    <span class="n">ny</span><span class="p">,</span> <span class="n">by</span><span class="p">,</span> <span class="n">px</span> <span class="o">=</span> <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">bins2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>\
                                <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span>\
                                    <span class="s1">'Difference'</span><span class="p">)</span>
    <span class="n">biny_max</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'binymax='</span><span class="p">,</span> <span class="n">biny_max</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median at:</span><span class="si">%0.2f</span><span class="s1">'</span><span class="o">%</span><span class="p">(</span><span class="n">by</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ny</span><span class="o">==</span><span class="n">biny_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]))</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Median and spread of the scatter ='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">)))</span>\
                       <span class="o">+</span><span class="sa">r</span><span class="s1">'$\pm$'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">))))</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'No. of sources lying in the range -0.2 &lt; ($K_</span><span class="si">{o}</span><span class="s1">$ - $K_</span><span class="si">{c}</span><span class="s1">$) &lt; 0.2 ='</span> <span class="o">+</span>\
                        <span class="nb">str</span><span class="p">(</span><span class="s2">"</span><span class="si">{:.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">indkp</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_kf</span><span class="p">))</span><span class="o">+</span><span class="s1">'%'</span><span class="p">))</span>
    <span class="c1"># Turn off tick labels on marginals</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_x</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax_marg_y</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Set labels on joint</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Observed K magnitude'</span><span class="p">)</span>
    <span class="n">ax_joint</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'$K_</span><span class="si">{UKIDSS}</span><span class="s1">$ - $K_</span><span class="si">{Computed}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="c1"># Set labels on marginals</span>
    <span class="n">ax_marg_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">ax_marg_x</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'N'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'validation_plot_k'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'RA'</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'_'</span> <span class="o">+</span> <span class="s1">'DEC'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span><span class="o">+</span>\
                <span class="s1">'.png'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../apireference/" title="API"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../tutorials/" title="Tutorials">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span>
<a class="fa fa-github" href="https://github.com/sshah1502/irgsc/" style="color: #fcfcfc"> GitHub</a>
</span>
<span><a href="../apireference/" style="color: #fcfcfc">Â« Previous</a></span>
<span><a href="../tutorials/" style="color: #fcfcfc">Next Â»</a></span>
</span>
</div>
<script>var base_url = '..';</script>
<script defer="" src="../js/theme_extra.js"></script>
<script defer="" src="../js/theme.js"></script>
<script defer="" src="../javascripts/mathjax.js"></script>
<script defer="" src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script defer="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script defer="" src="../search/main.js"></script>
<script defer="">
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>
<script>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});</script></body>
</html>
